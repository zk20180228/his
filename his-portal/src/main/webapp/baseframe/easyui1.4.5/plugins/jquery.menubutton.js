!function(n){function t(t){var e=n.data(t,"menubutton").options,o=n(t);if(o.linkbutton(e),e.hasDownArrow){o.removeClass(e.cls.btn1+" "+e.cls.btn2).addClass("m-btn"),o.removeClass("m-btn-small m-btn-medium m-btn-large").addClass("m-btn-"+e.size);var u=o.find(".l-btn-left");n("<span></span>").addClass(e.cls.arrow).appendTo(u),n("<span></span>").addClass("m-btn-line").appendTo(u)}if(n(t).menubutton("resize"),e.menu){n(e.menu).menu({duration:e.duration});var i=n(e.menu).menu("options"),s=i.onShow,a=i.onHide;n.extend(i,{onShow:function(){var t=n(this).menu("options"),e=n(t.alignTo),o=e.menubutton("options");e.addClass(1==o.plain?o.cls.btn2:o.cls.btn1),s.call(this)},onHide:function(){var t=n(this).menu("options"),e=n(t.alignTo),o=e.menubutton("options");e.removeClass(1==o.plain?o.cls.btn2:o.cls.btn1),a.call(this)}})}}function e(t){function e(){return n(t).linkbutton("options").disabled}var u=n.data(t,"menubutton").options,i=n(t),s=i.find("."+u.cls.trigger);s.length||(s=i),s.unbind(".menubutton");var a=null;s.bind("click.menubutton",function(){if(!e())return o(t),!1}).bind("mouseenter.menubutton",function(){if(!e())return a=setTimeout(function(){o(t)},u.duration),!1}).bind("mouseleave.menubutton",function(){a&&clearTimeout(a),n(u.menu).triggerHandler("mouseleave")})}function o(t){var e=n(t).menubutton("options");if(!e.disabled&&e.menu){n("body>div.menu-top").menu("hide");var o=n(t),u=n(e.menu);u.length&&(u.menu("options").alignTo=o,u.menu("show",{alignTo:o,align:e.menuAlign})),o.blur()}}n.fn.menubutton=function(o,u){if("string"==typeof o){var i=n.fn.menubutton.methods[o];return i?i(this,u):this.linkbutton(o,u)}return o=o||{},this.each(function(){var u=n.data(this,"menubutton");u?n.extend(u.options,o):(n.data(this,"menubutton",{options:n.extend({},n.fn.menubutton.defaults,n.fn.menubutton.parseOptions(this),o)}),n(this).removeAttr("disabled")),t(this),e(this)})},n.fn.menubutton.methods={options:function(t){var e=t.linkbutton("options");return n.extend(n.data(t[0],"menubutton").options,{toggle:e.toggle,selected:e.selected,disabled:e.disabled})},destroy:function(t){return t.each(function(){var t=n(this).menubutton("options");t.menu&&n(t.menu).menu("destroy"),n(this).remove()})}},n.fn.menubutton.parseOptions=function(t){n(t);return n.extend({},n.fn.linkbutton.parseOptions(t),n.parser.parseOptions(t,["menu",{plain:"boolean",hasDownArrow:"boolean",duration:"number"}]))},n.fn.menubutton.defaults=n.extend({},n.fn.linkbutton.defaults,{plain:!0,hasDownArrow:!0,menu:null,menuAlign:"left",duration:100,cls:{btn1:"m-btn-active",btn2:"m-btn-plain-active",arrow:"m-btn-downarrow",trigger:"m-btn"}})}(jQuery);